syntax = "proto3";

package geovision;

import "model/osint.proto";
import "google/api/annotations.proto";

option go_package = "github.com/bouncingmaxt/omniscent-library/gen/go/geovision;geovision";

// EventService provides operations for managing events
service EventService {
  rpc GetEvents(GetEventsRequest) returns (GetEventsResponse) {
    option (google.api.http) = {
      get: "/v1/events"
    };
  }

  rpc GetEvent(GetEventRequest) returns (GetEventResponse) {
    option (google.api.http) = {
      get: "/v1/events/{key}"
    };
  }

  rpc GetEventRelatedEntities(GetEventRelatedEntitiesRequest) returns (GetEventRelatedEntitiesResponse) {
    option (google.api.http) = {
      get: "/v1/events/{key}/related-entities"
    };
  }

  rpc CreateEvent(CreateEventRequest) returns (CreateEventResponse) {
    option (google.api.http) = {
      post: "/v1/events"
      body: "event"
    };
  }

  rpc UpdateEvent(UpdateEventRequest) returns (UpdateEventResponse) {
    option (google.api.http) = {
      put: "/v1/events/{key}"
      body: "event"
    };
  }

  rpc DeleteEvent(DeleteEventRequest) returns (DeleteEventResponse) {
    option (google.api.http) = {
      delete: "/v1/events/{key}"
    };
  }
}

// Event messages
message GetEventsRequest {
  int64 start_time = 1;
  int64 end_time = 2;
}

message GetEventsResponse {
  repeated RelatedEvent events = 1;

  message RelatedEvent {
    model.Relation relation = 1;
    model.Event event = 2;
  }
}

message GetEventRequest {
  string key = 1;
}

message GetEventResponse {
  model.Event event = 1;
}

message GetEventRelatedEntitiesRequest {
  string key = 1;
}

message GetEventRelatedEntitiesResponse {
  repeated Related entities = 1;

  message Related {
    model.Relation relation = 1;
    oneof entity {
      model.Source source = 2;
      model.Person person = 3;
      model.Organization organization = 4;
      model.Website website = 5;
    }
  }
}

message CreateEventRequest {
  model.Event event = 1;
}

message CreateEventResponse {
  model.Event event = 1;
}

message UpdateEventRequest {
  string key = 1;
  model.Event event = 2;
}

message UpdateEventResponse {
  model.Event event = 1;
}

message DeleteEventRequest {
  string key = 1;
}

message DeleteEventResponse {
}